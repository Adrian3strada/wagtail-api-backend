{% extends "base.html" %}
{% load wagtailcore_tags %}

{% block title %}Noticias - {{ page.title }}{% endblock %}

{% block content %}
<h2>{{ page.title }}</h2>

<form method="get" class="mb-4">
    <div class="row">
        <div class="col-md-6">
            <select name="categoria" class="form-select" onchange="this.form.submit()">
                <option value="">Todas las categorías</option>
                {% for cat in categorias %}
                <option value="{{ cat.slug }}" {% if cat.slug == current_categoria %}selected{% endif %}>{{ cat.nombre }}
                </option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-6">
            <select name="tag" class="form-select" onchange="this.form.submit()">
                <option value="">Todas las etiquetas</option>
                {% for t in tags %}
                <option value="{{ t.slug }}" {% if t.slug == urrent_tag %}selected{% endif %}>{{ t.name }}</option>
                {% endfor %}
            </select>
        </div>
    </div>
</form>

<div class="row">
    {% if noticias %}
    {% for noticia in noticias %}
    <div class="col-md-4 mb-4">
        <div class="card h-100">
            {% if noticia.imagen %}
            <img src="{{ noticia.imagen.url }}" class="card-img-top" alt="{{ noticia.title }}">
            {% endif %}
            <div class="card-body">
                <h5 class="card-title">{{ noticia.title }}</h5>
                <p class="card-text">
                    <small class="text-muted">{{ noticia.fecha }}</small><br>
                    {% if noticia.categoria %}
                    <strong>Categoría:</strong> {{ noticia.categoria.nombre }}
                    {% endif %}
                </p>
                <a href="{{ noticia.url }}" class="btn btn-primary">Leer más</a>
            </div>
        </div>
    </div>
    {% endfor %}
    {% else %}
    <div class="col-12">
        <p>No hay noticias disponibles.</p>
    </div>
    {% endif %}
</div>
{% endblock %}