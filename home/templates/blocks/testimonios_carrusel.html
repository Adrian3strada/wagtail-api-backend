    {% load wagtailcore_tags wagtailimages_tags %}
    <div id="testimoniosCarousel" class="carousel slide carousel-fade mb-5" data-bs-ride="carousel">

        <div class="carousel-inner">
            {% for testimonio in self.testimonios %}
            <div class="carousel-item {% if forloop.first %}active{% endif %}">
                <div class="position-relative text-white" style="min-height: 400px;">
                    {% if testimonio.fondo %}
                    <div class="position-absolute top-0 start-0 w-100 h-100 overflow-hidden"
                        style="z-index: 0; opacity: 0.3;">
                        {% image testimonio.fondo fill-1600x600-c100 as fondo_img %}
                        <img src="{{ fondo_img.url }}" alt="{{ testimonio.nombre }}" class="w-100 h-100 object-fit-cover">
                    </div>
                    {% endif %}

                    <div class="position-relative py-5 px-3" style="z-index: 1; max-width: 900px; margin: 0 auto;">
                        {% if testimonio.imagen %}
                        <div class="mb-4 text-center">
                            {% image testimonio.imagen fill-300x300-c100 as imagen_img %}
                            <img src="{{ imagen_img.url }}" alt="{{ testimonio.nombre }}"
                                class="rounded-circle mx-auto d-block"
                                style="width:150px; height:150px; object-fit: cover; border: 4px solid rgba(255,255,255,0.6);">
                        </div>
                        {% endif %}
                        <blockquote class="blockquote">
                            <p class="fs-5 fw-light">“{{ testimonio.comentario }}”</p>
                            <footer class="blockquote-footer text-white-50 mt-3">
                                {{ testimonio.nombre }}
                                {% if testimonio.organizacion %} – {{ testimonio.organizacion }}{% endif %}
                            </footer>
                        </blockquote>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#testimoniosCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
            <span class="visually-hidden">Anterior</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#testimoniosCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
            <span class="visually-hidden">Siguiente</span>
        </button>
    </div>

    <style>
        #testimoniosCarousel {
            width: 100vw;
            /* full viewport width */
            margin-left: calc(-50vw + 50%);
            /* para que el carrusel se "extienda" al borde izquierdo */
        }

        #testimoniosCarousel .carousel-item {
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            border-radius: 0;
            /* sin bordes para cubrir ancho total */
            box-shadow: none;
            background-color: #222;
        }

        #testimoniosCarousel .position-absolute {
            border-radius: 0;
        }

        #testimoniosCarousel .object-fit-cover {
            object-fit: cover;
        }

        #testimoniosCarousel blockquote {
            max-width: 700px;
            margin: 0 auto;
            text-align: center;
            text-shadow: 0 1px 4px rgba(0, 0, 0, 0.7);
        }

        #testimoniosCarousel .blockquote-footer {
            font-size: 1rem;
            color: #ccc !important;
        }

        #testimoniosCarousel img.rounded-circle {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border: 4px solid rgba(255, 255, 255, 0.6);
        }

        /* Responsive tweaks */
        @media (max-width: 768px) {
            #testimoniosCarousel .carousel-item {
                min-height: 350px;
                padding: 20px;
            }

            #testimoniosCarousel img.rounded-circle {
                width: 100px;
                height: 100px;
                border-width: 3px;
            }

            #testimoniosCarousel blockquote p {
                font-size: 1.1rem;
            }
        }
    </style>