{% load wagtailcore_tags wagtailimages_tags %}

<div id="testimoniosCarousel" class="carousel slide carousel-fade mb-5" data-bs-ride="carousel">
    <div class="carousel-inner">
        {% for testimonio in self.testimonios %}
        <div class="carousel-item {% if forloop.first %}active{% endif %}"
            style="background-color: transparent !important;">
            <div class="position-relative d-flex align-items-center justify-content-center"
                style="min-height: 500px; background-color: transparent !important;">

                {% if testimonio.fondo %}
                <div class="position-absolute top-0 start-0 w-100 h-100 overflow-hidden" style="z-index: 0;">
                    {% image testimonio.fondo fill-1600x600-c100 as fondo_img %}
                    <img src="{{ fondo_img.url }}" alt="{{ testimonio.nombre }}"
                        class="w-100 h-100 object-fit-cover position-absolute top-0 start-0 z-0">

                </div>
                {% endif %}

                <div class="position-relative z-1 px-3 py-5 text-center text-white" style="max-width: 800px;">
                    {% if testimonio.imagen %}
                    <div class="mb-4">
                        {% image testimonio.imagen fill-300x300-c100 as imagen_img %}
                        <img src="{{ imagen_img.url }}" alt="{{ testimonio.nombre }}"
                            class="rounded-circle shadow-lg border border-4 border-white"
                            style="width: 140px; height: 140px; object-fit: cover;">
                    </div>
                    {% endif %}
                    <blockquote class="blockquote">
                        <p class="fs-4 fst-italic">“{{ testimonio.comentario }}”</p>
                        <footer class="blockquote-footer text-warning mt-3 fw-semibold">
                            {{ testimonio.nombre }}
                            {% if testimonio.organizacion %} – {{ testimonio.organizacion }}{% endif %}
                        </footer>
                    </blockquote>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Controles -->
    <button class="carousel-control-prev" type="button" data-bs-target="#testimoniosCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon bg-dark rounded-circle p-2" aria-hidden="true"></span>
        <span class="visually-hidden">Anterior</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#testimoniosCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon bg-dark rounded-circle p-2" aria-hidden="true"></span>
        <span class="visually-hidden">Siguiente</span>
    </button>
</div>